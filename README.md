![example workflow](https://github.com/DScherbanev/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)

# Проект YaMDb
Проект **YaMDb** собирает отзывы пользователей на различные произведения.
В данном проекте описан API для работы с YaMDb.

# Технологии
- Django REST framework
- Git
- NGINX
- Gunicorn
- Postgres
- Docker

# Как запустить проект:

Склонируйте репозиторий:

```
git clone git@github.com:DScherbanev/infra_sp2.git
```
  
 Перейдите в директорию infra_sp2/infra/ и создайте файл .env:
Шаблон .env файла:
```
DB_ENGINE=django.db.backends.postgresql # указываем, что работаем с postgresql
DB_NAME=postgres # имя базы данных
POSTGRES_USER=username # логин для подключения к базе данных
POSTGRES_PASSWORD=password # пароль для подключения к БД (установите свой)
DB_HOST=db # название сервиса (контейнера)
DB_PORT=5432 # порт для подключения к БД 
```
Для запуска приложения в контейнерах в директории infra_sp2/infra/ выполните команду:
```
docker-compose up
```
Для создания суперпользователя выполните команду:
```
docker-compose exec web python manage.py createsuperuser
```
Для загрузки фикстур в БД выполните команду:
```
docker-compose exec web python manage.py loaddata fixtures.json
```
После запуска контейнеров проект готов к работе и доступен по адресу http://localhost/api/v1/
Доступ к административной панели доступен по адресу: http://localhost/admin/

# Документация к API проекта YaMDb

К проекту подключен REDOC: http://127.0.0.1/redoc/
Там вы можете ознакомиться с эндпоинтами и методами, а также с примерами запросов, ответов и кода.

# Алгоритм регистрации пользователей

1.  Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами  `email`  и  `username`  на эндпоинт  `/api/v1/auth/signup/`.
2.  **YaMDB**  отправляет письмо с кодом подтверждения (`confirmation_code`) на адрес  `email`.
3.  Пользователь отправляет POST-запрос с параметрами  `username`  и  `confirmation_code`  на эндпоинт  `/api/v1/auth/token/`, в ответе на запрос ему приходит  `token`  (JWT-токен).
4.  При желании пользователь отправляет PATCH-запрос на эндпоинт  `/api/v1/users/me/`  и заполняет поля в своём профайле (описание полей — в документации).

# Пользовательские роли

-   **Аноним**  — может просматривать описания произведений, читать отзывы и комментарии.
-   **Аутентифицированный пользователь**  (`user`) — может, как и  **Аноним**, читать всё, дополнительно он может публиковать отзывы и ставить оценку произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы; может редактировать и удалять  **свои**  отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.
-   **Модератор**  (`moderator`) — те же права, что и у  **Аутентифицированного пользователя**  плюс право удалять  **любые**  отзывы и комментарии.
-   **Администратор**  (`admin`) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
-   **Суперюзер Django**  — обладет правами администратора (`admin`)

# Автор
Дмитрий Щербанев
scherbanev.d@yandex.ru
